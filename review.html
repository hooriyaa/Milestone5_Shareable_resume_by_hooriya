<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Review Resume</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h1>Your Resume</h1>
      <div id="resume-content"></div>
      <button id="download-btn" style="margin: 22px; margin-left: 13rem">
        Download PDF
      </button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const userName = new URLSearchParams(window.location.search).get(
          "username"
        );
        const resumeData = JSON.parse(localStorage.getItem(userName));

        if (resumeData) {
          document.getElementById("resume-content").innerHTML = `
            <h3>${resumeData.name}</h3>
            <p>Email: ${resumeData.email}</p>
            ${
              resumeData.degree || resumeData.school || resumeData.gradYear
                ? `<h4>Education</h4>`
                : ""
            }
            <p>${resumeData.degree} ${
            resumeData.school ? "from " + resumeData.school : ""
          } ${
            resumeData.gradYear ? "(Class of " + resumeData.gradYear + ")" : ""
          }</p>
            ${
              resumeData.jobTitle || resumeData.company || resumeData.years
                ? `<h4>Work Experience</h4>`
                : ""
            }
            <p>${resumeData.jobTitle} ${
            resumeData.company ? "at " + resumeData.company : ""
          } ${resumeData.years ? "(" + resumeData.years + " years)" : ""}</p>
            ${
              resumeData.skills.length
                ? `<h4>Skills</h4><ul>${resumeData.skills
                    .map((skill) => `<li>${skill}</li>`)
                    .join("")}</ul>`
                : ""
            }
          `;
        } else {
          document.getElementById("resume-content").innerHTML =
            "<p>Resume not found.</p>";
        }

        document.getElementById("download-btn").onclick = () => {
          const opt = {
            margin: 1,
            filename: "Resume.pdf",
            image: { type: "jpeg", quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: "in", format: "letter", orientation: "portrait" },
          };
          html2pdf()
            .from(document.getElementById("resume-content"))
            .set(opt)
            .save();
        };
      });
    </script>
  </body>
</html>
